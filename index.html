<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lodge Management Admin Tool</title>
    <style>
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        th { background-color: #f2f2f2; text-align: left; }
        button { margin: 5px; }
        .collapsible { cursor: pointer; }
    </style>
</head>
<body>
    <h1>Lodge Management Admin Tool</h1>
    <table id="lodgeTable">
        <thead>
            <tr>
                <th>Name</th>
                <th>Status</th>
                <th>City</th>
                <th>Verified</th>
                <th>RVC Home</th>
                <th>Ranking Officer</th>
                <th>Total Officers</th>
                <th>Total Venues</th>
                <th>Total Acquisition Events</th>
                <th>Total Conventions</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <!-- Lodge rows will be populated here -->
        </tbody>
    </table>
    <div>
        <button onclick="exportJSON()">Export JSON</button>
        <button onclick="exportCSV()">Export CSV</button>
        <button onclick="importJSON()">Import JSON</button>
        <button onclick="importCSV()">Import CSV</button>
        <button onclick="addLodge()">Add Lodge</button>
        <button onclick="resetAll()">Master Reset</button>
    </div>
    <script>
        // Functionality for managing lodge data
        const lodgeData = []; // This will hold the lodge information

        function renderTable() {
            const tableBody = document.getElementById('lodgeTable').getElementsByTagName('tbody')[0];
            tableBody.innerHTML = '';
            lodgeData.forEach((lodge, index) => {
                const row = tableBody.insertRow();
                row.innerHTML = `
                    <td contenteditable="true">${lodge.name}</td>
                    <td contenteditable="true">${lodge.status}</td>
                    <td contenteditable="true">${lodge.city}</td>
                    <td>${lodge.verified ? 'Yes' : 'No'}</td>
                    <td>${lodge.rvcHome ? 'Yes' : 'No'}</td>
                    <td>${lodge.rankingOfficer}</td>
                    <td>${lodge.totalOfficers}</td>
                    <td>${lodge.totalVenues}</td>
                    <td>${lodge.totalAcquisitionEvents}</td>
                    <td>${lodge.totalConventions}</td>
                    <td><button onclick="deleteLodge(${index})">Delete</button></td>
                `;
            });
        }

        function addLodge() {
            const newLodge = { name: 'New Lodge', status: 'Active', city: '', verified: false, rvcHome: false, rankingOfficer: '', totalOfficers: 0, totalVenues: 0, totalAcquisitionEvents: 0, totalConventions: 0 };
            lodgeData.push(newLodge);
            renderTable();
            saveToLocalStorage();
        }

        function deleteLodge(index) {
            lodgeData.splice(index, 1);
            renderTable();
            saveToLocalStorage();
        }

        function resetAll() {
            if (confirm('Are you sure you want to reset all lodge data?')) {
                lodgeData.length = 0;
                renderTable();
                saveToLocalStorage();
            }
        }

        function exportJSON() {
            const blob = new Blob([JSON.stringify(lodgeData)], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'lodges.json';
            link.click();
        }

        function importJSON() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = e => {
                    lodgeData.push(...JSON.parse(e.target.result));
                    renderTable();
                    saveToLocalStorage();
                };
                reader.readAsText(file);
            };
            input.click();
        }

        function exportCSV() {
            const rows = lodgeData.map(lodge => [lodge.name, lodge.status, lodge.city, lodge.verified ? 'Yes' : 'No', lodge.rvcHome ? 'Yes' : 'No', lodge.rankingOfficer, lodge.totalOfficers, lodge.totalVenues, lodge.totalAcquisitionEvents, lodge.totalConventions]);
            const csvContent = 'data:text/csv;charset=utf-8,' + rows.map(e => e.join(',')).join('\n');
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', 'lodges.csv');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function importCSV() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.csv';
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = e => {
                    const rows = e.target.result.split('\n').map(row => row.split(','));
                    lodgeData.push(...rows.map(row => ({ name: row[0], status: row[1], city: row[2], verified: row[3] === 'Yes', rvcHome: row[4] === 'Yes', rankingOfficer: row[5], totalOfficers: parseInt(row[6]), totalVenues: parseInt(row[7]), totalAcquisitionEvents: parseInt(row[8]), totalConventions: parseInt(row[9]) })));
                    renderTable();
                    saveToLocalStorage();
                };
                reader.readAsText(file);
            };
            input.click();
        }

        function saveToLocalStorage() {
            localStorage.setItem('lodgeData', JSON.stringify(lodgeData));
        }
        
        function loadFromLocalStorage() {
            const data = localStorage.getItem('lodgeData');
            if (data) {
                lodgeData.push(...JSON.parse(data));
                renderTable();
            }
        }
        
        window.onload = loadFromLocalStorage;
    </script>
</body>
</html>
